<!DOCTYPE html>
<html lang="uk" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç—ñ–≤ - PizzaGo</title>
    <link rel="stylesheet" th:href="@{/styles/client-styles.css}" />
    <link rel="stylesheet" th:href="@{/styles/admin.css}" />
    <style>

    </style>
</head>
<body>

<header class="header">
    <div class="logo"><a th:href="@{/}"><img th:src="@{/images/Logo.svg}" alt="" /></a></div>
    <nav class="header-navigation">
        <a th:href="@{/admin-crud}">–¢–æ–≤–∞—Ä–∏</a>
        <a th:href="@{/admin/orders}">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
        <a th:href="@{/admin/cars}">–ê–≤—Ç–æ–ø–∞—Ä–∫</a>
        <a th:href="@{/admin/ingredients}">–°–∫–ª–∞–¥</a>
        <a th:href="@{/admin/recipes}" style="font-weight: bold; color: #6a4821;">–†–µ—Ü–µ–ø—Ç–∏</a>
        <a th:href="@{/admin/stats}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
    </nav>
    <div class="header-user-actions">
        <svg class="ham hamRotate ham7" viewBox="0 0 100 100"  onclick="toggleMobileMenu()" id="burger-btn">
            <path class="line top" d="m 70,33 h -40 c 0,0 -6,1.368796 -6,8.5 0,7.131204 6,8.5013 6,8.5013 l 20,-0.0013" />
            <path class="line middle" d="m 70,50 h -40" />
            <path class="line bottom" d="m 69.575405,67.073826 h -40 c -5.592752,0 -6.873604,-9.348582 1.371031,-9.348582 8.244634,0 19.053564,21.797129 19.053564,12.274756 l 0,-40" />
        </svg>
        <a style="font-weight: bold; cursor:auto; margin-right:10px;cursor:pointer;" onclick="handleUserClick(event)">–ê–¥–º—ñ–Ω –ü–∞–Ω–µ–ª—å</a>
        <a href="#" onclick="logout()" style="color: red; text-decoration: none;">–í–∏—Ö—ñ–¥</a>
    </div>

    <div id="mobileMenu">
        <div class="mobile-menu-content">
            <nav class="mobile-header-navigation">
                <a th:href="@{/admin-crud}" style="font-weight: bold; color: #6a4821;">–¢–æ–≤–∞—Ä–∏</a>
                <a th:href="@{/admin/orders}">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
                <a th:href="@{/admin/cars}">–ê–≤—Ç–æ–ø–∞—Ä–∫</a>
                <a th:href="@{/admin/ingredients}">–°–∫–ª–∞–¥</a>
                <a th:href="@{/admin/recipes}">–†–µ—Ü–µ–ø—Ç–∏</a>
                <a th:href="@{/admin/stats}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                <a href="#" onclick="logout()" style="color: red; text-decoration: none;">–í–∏—Ö—ñ–¥</a>
            </nav>
        </div>
    </div>
</header>

<main class="conteiner" style="display: block;">
    <h2 style="margin: 30px 0;">üìö –ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç—ñ–≤</h2>

    <div th:each="product : ${products}" class="recipe-card">
        <div class="recipe-info">
            <h3 th:text="${product.name}">–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞</h3>
            <span style="font-size: 12px; color: #888;" th:text="${product.category}">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</span>

            <div class="ingredients-preview">
                <span th:if="${#lists.isEmpty(product.recipes)}" style="color: #dc3545; font-weight: bold; font-size: 12px;">
                    ‚ö†Ô∏è –†–µ—Ü–µ–ø—Ç –≤—ñ–¥—Å—É—Ç–Ω—ñ–π
                </span>

                <span class="ing-tag" th:each="rec : ${product.recipes}"
                      th:if="${rec.ingredient != null}"
                      th:text="${rec.ingredient.name} + ': ' + ${rec.amount.stripTrailingZeros().toPlainString()} + ' ' + (${rec.ingredient.unitOfMeasure} ?: '')"
                </span>
            </div>
        </div>

        <button class="btn-recipe"
                th:data-id="${product.id}"
                th:data-name="${product.name}"
                th:data-price="${product.price}"
                th:data-img="${product.imageUrl}"
                th:data-cat="${product.category}"
                onclick="openRecipeEditor(this)">
            üìù –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
        </button>
    </div>
</main>

<div id="recipeModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>

        <div class="modal-header">
            <img id="modalImg" src="" alt="–°—Ç—Ä–∞–≤–∞" class="modal-dish-img" onerror="this.src='/images/Logo.svg'"> <div class="modal-dish-info">
            <h2 id="modalDishName">–ù–∞–∑–≤–∞ —Å—Ç—Ä–∞–≤–∏</h2>
            <p>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: <span id="modalCat">–ü—ñ—Ü–∞</span> | –¶—ñ–Ω–∞: <span id="modalPrice">0</span> –≥—Ä–Ω</p>
        </div>
        </div>

        <div class="modal-body">
            <input type="hidden" id="currentProductId">

            <div style="background: #e3f2fd; padding: 15px; border-radius: 10px;">
                <label style="font-weight: bold; font-size: 14px; margin-bottom: 5px; display:block;">–î–æ–¥–∞—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç:</label>
                <div style="display: flex; gap: 10px;">
                    <select id="newIngSelect" style="flex: 2; padding: 10px; border-radius: 8px; border: 1px solid #ccc;">
                        <option value="">-- –û–±–µ—Ä—ñ—Ç—å –∑—ñ —Å–∫–ª–∞–¥—É --</option>
                        <option th:each="ing : ${ingredients}"
                                th:value="${ing.id}"
                                th:data-unit="${ing.unitOfMeasure}"
                                th:text="${ing.name} + ' (' + ${ing.unitOfMeasure} + ')'">
                        </option>
                    </select>
                    <input type="number" id="newIngAmount" step="0.001" placeholder="–ö-—Å—Ç—å" style="flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ccc;">
                    <button onclick="addIngredientToRecipe()" style="background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 50px; font-size: 20px;">+</button>
                </div>
            </div>

            <h4 style="margin-top: 20px; color: #193948;">–ü–æ—Ç–æ—á–Ω–∏–π —Å–∫–ª–∞–¥:</h4>
            <div id="modalIngredientsList" class="ing-list"></div>

            <div style="margin-top: 20px; text-align: right;">
                <button onclick="saveRecipeChanges()" class="btn-recipe" style="width: 100%;">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/js/client.js}"></script>
<script th:src="@{/js/admin.js}"></script>



</body>
</html>